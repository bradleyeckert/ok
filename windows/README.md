# Compiling for Windows

`ok` is a Windows console application written mostly in C99.
`main.cpp` uses C11++ for threading.

There are at least three threads. They are:

- The main execution thread, which is blocked when waiting for stdin.
- A thread to process incoming RS232 data.
- A thread to execute code on the VM.

## Visual Studio

The Visual Studio 2022 `ok.sln` uses a C++ version of `main`.
`main.cpp` assumes the use of Windows libraries, including `<thread>`.

You get the best performance compiling for 32-bit, optimized for speed.
It is still a few percent slower than code generated by Code::Blocks 20.03.

## makefile

You may be able to run the makefile, just like with Linux, under Windows. I could not.
Maybe the wrong version of `make` was in the path.

## Code::Blocks

Code::Blocks works under Windows after creating a project and adding files recursively.
You should enable static linking, otherwise the runtime may complain about a missing `libwinpthread-1.dll`.
There are likely multiple versions of `libwinpthread-1.dll` on your computer. Some will work, some won't.
